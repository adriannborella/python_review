<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog API Frontend</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .post-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .auth-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .like-btn.liked {
            color: #e91e63;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="loadPosts()">
                <i class="fas fa-blog"></i> Blog API
            </a>
            <div class="navbar-nav ms-auto">
                <div id="auth-buttons">
                    <button class="btn btn-outline-light me-2" onclick="showLoginModal()">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="btn btn-light" onclick="showRegisterModal()">
                        <i class="fas fa-user-plus"></i> Registrarse
                    </button>
                </div>
                <div id="user-menu" style="display: none;">
                    <span class="navbar-text me-3" id="user-info"></span>
                    <button class="btn btn-success me-2" onclick="showCreatePostModal()">
                        <i class="fas fa-plus"></i> Crear Post
                    </button>
                    <button class="btn btn-outline-light" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Filtros y búsqueda -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="input-group">
                    <input type="text" class="form-control" id="searchInput" placeholder="Buscar posts...">
                    <button class="btn btn-primary" onclick="searchPosts()">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            <div class="col-md-4">
                <select class="form-select" id="categoryFilter" onchange="filterByCategory()">
                    <option value="">Todas las categorías</option>
                </select>
            </div>
        </div>

        <!-- Contenido principal -->
        <div class="row">
            <div class="col-lg-8">
                <div id="posts-container">
                    <div class="text-center">
                        <div class="loading"></div>
                        <p>Cargando posts...</p>
                    </div>
                </div>
                
                <!-- Paginación -->
                <nav id="pagination" style="display: none;"></nav>
            </div>
            
            <div class="col-lg-4">
                <!-- Estadísticas -->
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="fas fa-chart-bar"></i> Estadísticas
                    </div>
                    <div class="card-body" id="stats-container">
                        <div class="loading"></div>
                    </div>
                </div>

                <!-- Categorías -->
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-tags"></i> Categorías
                    </div>
                    <div class="card-body" id="categories-container">
                        <div class="loading"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Login -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Iniciar Sesión</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="loginForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Usuario</label>
                            <input type="text" class="form-control" name="username" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contraseña</label>
                            <input type="password" class="form-control" name="password" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">
                            <span class="login-loading" style="display: none;"><i class="loading"></i></span>
                            Iniciar Sesión
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Registrarse</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="registerForm">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nombre</label>
                                    <input type="text" class="form-control" name="first_name" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Apellido</label>
                                    <input type="text" class="form-control" name="last_name" required>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Usuario</label>
                            <input type="text" class="form-control" name="username" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contraseña</label>
                            <input type="password" class="form-control" name="password" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Confirmar Contraseña</label>
                            <input type="password" class="form-control" name="password_confirm" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">
                            <span class="register-loading" style="display: none;"><i class="loading"></i></span>
                            Registrarse
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Crear Post -->
    <div class="modal fade" id="createPostModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Crear Nuevo Post</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form id="createPostForm">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label class="form-label">Título</label>
                            <input type="text" class="form-control" name="title" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Categoría</label>
                            <select class="form-select" name="category" id="postCategorySelect" required>
                                <option value="">Selecciona una categoría</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Contenido</label>
                            <textarea class="form-control" name="content" rows="10" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Excerpt (opcional)</label>
                            <textarea class="form-control" name="excerpt" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Tags (separados por comas)</label>
                            <input type="text" class="form-control" name="tags" placeholder="python, django, web">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Estado</label>
                            <select class="form-select" name="status">
                                <option value="draft">Borrador</option>
                                <option value="published">Publicado</option>
                            </select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-success">
                            <span class="create-post-loading" style="display: none;"><i class="loading"></i></span>
                            Crear Post
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Detalle de Post -->
    <div class="modal fade" id="postDetailModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="postDetailTitle"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="postDetailBody">
                    <div class="loading"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Configuración de la API
        const API_BASE_URL = 'http://localhost:8000/api/v1';
        
        // Estado de la aplicación
        let currentUser = null;
        let currentToken = null;
        let currentPage = 1;
        let currentFilters = {};

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar token guardado
            const savedToken = localStorage.getItem('auth_token');
            const savedUser = localStorage.getItem('user_info');
            
            if (savedToken && savedUser) {
                currentToken = savedToken;
                currentUser = JSON.parse(savedUser);
                updateAuthUI();
            }
            
            // Cargar datos iniciales
            loadPosts();
            loadCategories();
            loadStats();
            
            // Event listeners
            setupEventListeners();
        });

        // Configurar event listeners
        function setupEventListeners() {
            // Enter en búsqueda
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchPosts();
                }
            });

            // Formulario de login
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Formulario de registro
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            
            // Formulario de crear post
            document.getElementById('createPostForm').addEventListener('submit', handleCreatePost);
        }

        // Utilidades de API
        async function apiRequest(endpoint, options = {}) {
            const url = `${API_BASE_URL}${endpoint}`;
            const defaultOptions = {
                headers: {
                    'Content-Type': 'application/json',
                },
            };

            if (currentToken) {
                defaultOptions.headers['Authorization'] = `Token ${currentToken}`;
            }

            const response = await fetch(url, {
                ...defaultOptions,
                ...options,
                headers: {
                    ...defaultOptions.headers,
                    ...options.headers,
                },
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.message || `HTTP error! status: ${response.status}`);
            }

            return response.json();
        }

        // Autenticación
        async function handleLogin(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const loginData = Object.fromEntries(formData.entries());
            
            try {
                document.querySelector('.login-loading').style.display = 'inline-block';
                
                const response = await fetch(`${API_BASE_URL}/auth/login/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(loginData)
                });
                
                if (response.ok) {
                    const data = await response.json();
                    currentToken = data.token;
                    
                    // Obtener info del usuario
                    const userResponse = await apiRequest('/users/me/');
                    currentUser = userResponse.data;
                    
                    // Guardar en localStorage
                    localStorage.setItem('auth_token', currentToken);
                    localStorage.setItem('user_info', JSON.stringify(currentUser));
                    
                    updateAuthUI();
                    bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                    showAlert('¡Bienvenido!', 'success');
                } else {
                    const error = await response.json();
                    showAlert(error.non_field_errors?.[0] || 'Error en login', 'danger');
                }
            } catch (error) {
                showAlert('Error de conexión', 'danger');
            } finally {
                document.querySelector('.login-loading').style.display = 'none';
            }
        }

        async function handleRegister(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const registerData = Object.fromEntries(formData.entries());
            
            try {
                document.querySelector('.register-loading').style.display = 'inline-block';
                
                const response = await apiRequest('/auth/register/', {
                    method: 'POST',
                    body: JSON.stringify(registerData)
                });
                
                currentToken = response.data.token;
                currentUser = response.data.user;
                
                localStorage.setItem('auth_token', currentToken);
                localStorage.setItem('user_info', JSON.stringify(currentUser));
                
                updateAuthUI();
                bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
                showAlert('¡Cuenta creada exitosamente!', 'success');
            } catch (error) {
                showAlert(error.message, 'danger');
            } finally {
                document.querySelector('.register-loading').style.display = 'none';
            }
        }

        function logout() {
            currentToken = null;
            currentUser = null;
            localStorage.removeItem('auth_token');
            localStorage.removeItem('user_info');
            updateAuthUI();
            showAlert('Sesión cerrada', 'info');
        }

        function updateAuthUI() {
            const authButtons = document.getElementById('auth-buttons');
            const userMenu = document.getElementById('user-menu');
            const userInfo = document.getElementById('user-info');
            
            if (currentUser) {
                authButtons.style.display = 'none';
                userMenu.style.display = 'block';
                userInfo.textContent = `Hola, ${currentUser.full_name || currentUser.username}`;
            } else {
                authButtons.style.display = 'block';
                userMenu.style.display = 'none';
            }
        }

        // Posts
        async function loadPosts(page = 1, filters = {}) {
            try {
                let endpoint = `/posts/?page=${page}`;
                
                // Agregar filtros
                if (filters.search) endpoint += `&search=${encodeURIComponent(filters.search)}`;
                if (filters.category) endpoint += `&category=${filters.category}`;
                
                const response = await apiRequest(endpoint);
                const posts = response.data.results;
                
                displayPosts(posts);
                displayPagination(response.data);
                currentPage = page;
                currentFilters = filters;
            } catch (error) {
                showAlert('Error cargando posts', 'danger');
            }
        }

        function displayPosts(posts) {
            const container = document.getElementById('posts-container');
            
            if (posts.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-info text-center">
                        <i class="fas fa-info-circle"></i>
                        No se encontraron posts
                    </div>
                `;
                return;
            }
            
            const postsHTML = posts.map(post => `
                <div class="card post-card mb-4">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <h5 class="card-title">
                                <a href="#" onclick="showPostDetail(${post.id})" class="text-decoration-none">
                                    ${post.title}
                                </a>
                            </h5>
                            <span class="badge bg-primary">${post.category.name}</span>
                        </div>
                        
                        <p class="card-text">${post.excerpt_generated}</p>
                        
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <small class="text-muted">
                                <i class="fas fa-user"></i> ${post.author.full_name}
                                <i class="fas fa-calendar ms-2"></i> ${formatDate(post.created_at)}
                                <i class="fas fa-clock ms-2"></i> ${post.read_time} min
                            </small>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                ${post.tags.map(tag => 
                                    `<span class="badge bg-secondary me-1">#${tag.name}</span>`
                                ).join('')}
                            </div>
                            <div>
                                <span class="text-muted me-3">
                                    <i class="fas fa-eye"></i> ${post.views_count}
                                </span>
                                <button class="btn btn-link btn-sm p-0 like-btn me-3" 
                                        onclick="toggleLike(${post.id})"
                                        ${!currentUser ? 'disabled' : ''}>
                                    <i class="fas fa-heart"></i> <span id="likes-${post.id}">${post.likes_count}</span>
                                </button>
                                <span class="text-muted">
                                    <i class="fas fa-comments"></i> ${post.comments_count}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = postsHTML;
        }

        function displayPagination(paginationData) {
            const container = document.getElementById('pagination');
            
            if (paginationData.total_pages <= 1) {
                container.style.display = 'none';
                return;
            }
            
            container.style.display = 'block';
            
            let paginationHTML = '<ul class="pagination justify-content-center">';
            
            // Botón anterior
            if (paginationData.links.previous) {
                paginationHTML += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="loadPosts(${currentPage - 1}, currentFilters)">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                `;
            }
            
            // Números de página
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(paginationData.total_pages, currentPage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="loadPosts(${i}, currentFilters)">${i}</a>
                    </li>
                `;
            }
            
            // Botón siguiente
            if (paginationData.links.next) {
                paginationHTML += `
                    <li class="page-item">
                        <a class="page-link" href="#" onclick="loadPosts(${currentPage + 1}, currentFilters)">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                `;
            }
            
            paginationHTML += '</ul>';
            container.innerHTML = paginationHTML;
        }

        async function showPostDetail(postId) {
            try {
                const response = await apiRequest(`/posts/${postId}/`);
                const post = response.data;
                
                document.getElementById('postDetailTitle').textContent = post.title;
                document.getElementById('postDetailBody').innerHTML = `
                    <div class="mb-4">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h6 class="text-muted mb-1">
                                    <i class="fas fa-user"></i> ${post.author.full_name}
                                    <span class="ms-3">
                                        <i class="fas fa-calendar"></i> ${formatDate(post.created_at)}
                                    </span>
                                </h6>
                                <span class="badge bg-primary">${post.category.name}</span>
                            </div>
                            <div class="text-end">
                                <small class="text-muted d-block">
                                    <i class="fas fa-eye"></i> ${post.views_count} vistas
                                </small>
                                <small class="text-muted d-block">
                                    <i class="fas fa-heart"></i> ${post.likes_count} likes
                                </small>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            ${post.tags.map(tag => 
                                `<span class="badge bg-secondary me-1">#${tag.name}</span>`
                            ).join('')}
                        </div>
                        
                        <div class="content">
                            ${post.content.replace(/\n/g, '<br>')}
                        </div>
                        
                        ${post.related_posts.length > 0 ? `
                            <hr>
                            <h6>Posts Relacionados:</h6>
                            <div class="row">
                                ${post.related_posts.map(relatedPost => `
                                    <div class="col-md-4">
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <h6 class="card-title">
                                                    <a href="#" onclick="showPostDetail(${relatedPost.id})" 
                                                       class="text-decoration-none">
                                                        ${relatedPost.title}
                                                    </a>
                                                </h6>
                                                <small class="text-muted">${formatDate(relatedPost.created_at)}</small>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
                
                new bootstrap.Modal(document.getElementById('postDetailModal')).show();
            } catch (error) {
                showAlert('Error cargando el post', 'danger');
            }
        }

        async function toggleLike(postId) {
            if (!currentUser) {
                showAlert('Debes iniciar sesión para dar like', 'warning');
                return;
            }
            
            try {
                const response = await apiRequest(`/posts/${postId}/like/`, {
                    method: 'POST'
                });
                
                const likeBtn = document.querySelector(`button[onclick="toggleLike(${postId})"]`);
                const likesSpan = document.getElementById(`likes-${postId}`);
                
                likesSpan.textContent = response.data.likes_count;
                
                if (response.data.liked) {
                    likeBtn.classList.add('liked');
                } else {
                    likeBtn.classList.remove('liked');
                }
            } catch (error) {
                showAlert('Error procesando like', 'danger');
            }
        }

        // Crear post
        async function handleCreatePost(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const postData = Object.fromEntries(formData.entries());
            
            // Procesar tags
            if (postData.tags) {
                postData.tags = postData.tags.split(',').map(tag => tag.trim()).filter(tag => tag);
            }
            
            try {
                document.querySelector('.create-post-loading').style.display = 'inline-block';
                
                await apiRequest('/posts/', {
                    method: 'POST',
                    body: JSON.stringify(postData)
                });
                
                bootstrap.Modal.getInstance(document.getElementById('createPostModal')).hide();
                e.target.reset();
                loadPosts(); // Recargar posts
                showAlert('¡Post creado exitosamente!', 'success');
            } catch (error) {
                showAlert(error.message, 'danger');
            } finally {
                document.querySelector('.create-post-loading').style.display = 'none';
            }
        }

        // Búsqueda y filtros
        function searchPosts() {
            const query = document.getElementById('searchInput').value;
            loadPosts(1, { ...currentFilters, search: query });
        }

        function filterByCategory() {
            const category = document.getElementById('categoryFilter').value;
            loadPosts(1, { ...currentFilters, category: category });
        }

        // Cargar datos del sidebar
        async function loadCategories() {
            try {
                const response = await apiRequest('/categories/');
                const categories = response.data.results || response.data;
                
                // Actualizar filtro de categorías
                const filterSelect = document.getElementById('categoryFilter');
                const postCategorySelect = document.getElementById('postCategorySelect');
                
                const categoriesHTML = categories.map(cat => 
                    `<option value="${cat.id}">${cat.name} (${cat.posts_count})</option>`
                ).join('');
                
                filterSelect.innerHTML = '<option value="">Todas las categorías</option>' + categoriesHTML;
                postCategorySelect.innerHTML = '<option value="">Selecciona una categoría</option>' + categoriesHTML;
                
                // Actualizar sidebar
                const container = document.getElementById('categories-container');
                container.innerHTML = categories.map(cat => `
                    <a href="#" onclick="filterByCategory('${cat.id}')" 
                       class="badge bg-secondary text-decoration-none me-2 mb-2">
                        ${cat.name} (${cat.posts_count})
                    </a>
                `).join('');
            } catch (error) {
                document.getElementById('categories-container').innerHTML = 
                    '<p class="text-muted">Error cargando categorías</p>';
            }
        }

        async function loadStats() {
            try {
                const response = await apiRequest('/stats/');
                const stats = response.data;
                
                document.getElementById('stats-container').innerHTML = `
                    <div class="row text-center">
                        <div class="col-6">
                            <h4 class="text-primary">${stats.total_posts}</h4>
                            <small>Posts</small>
                        </div>
                        <div class="col-6">
                            <h4 class="text-success">${stats.total_authors}</h4>
                            <small>Autores</small>
                        </div>
                        <div class="col-6 mt-3">
                            <h4 class="text-info">${stats.total_comments}</h4>
                            <small>Comentarios</small>
                        </div>
                        <div class="col-6 mt-3">
                            <h4 class="text-warning">${stats.posts_this_week}</h4>
                            <small>Esta semana</small>
                        </div>
                    </div>
                    
                    ${stats.top_categories.length > 0 ? `
                        <hr>
                        <h6>Top Categorías:</h6>
                        ${stats.top_categories.map(cat => 
                            `<div class="d-flex justify-content-between">
                                <span>${cat.name}</span>
                                <span class="badge bg-primary">${cat.posts_count}</span>
                            </div>`
                        ).join('')}
                    ` : ''}
                `;
            } catch (error) {
                document.getElementById('stats-container').innerHTML = 
                    '<p class="text-muted">Error cargando estadísticas</p>';
            }
        }

        // Utilidades
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function showAlert(message, type = 'info') {
            const alertHTML = `
                <div class="alert alert-${type} alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999;">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', alertHTML);
            
            // Auto-remover después de 5 segundos
            setTimeout(() => {
                const alert = document.querySelector('.alert:last-of-type');
                if (alert) {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }
            }, 5000);
        }

        // Funciones para modales
        function showLoginModal() {
            new bootstrap.Modal(document.getElementById('loginModal')).show();
        }

        function showRegisterModal() {
            new bootstrap.Modal(document.getElementById('registerModal')).show();
        }

        function showCreatePostModal() {
            if (!currentUser) {
                showAlert('Debes iniciar sesión para crear posts', 'warning');
                return;
            }
            new bootstrap.Modal(document.getElementById('createPostModal')).show();
        }
    </script>
</body>
</html>